module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(){function t(){this.extensions=[],this.parse=this.parse.bind(this),this.extend=this.extend.bind(this)}return t.prototype.parse=function(t){var e,n,r,o,i=this;return t?(n=RegExp(/{{\s*(.*?)\s*}}/g),(r=t.match(n))&&r.length&&r.length>0&&r.forEach((function(n){o=n,n=(n="{"+n+"}").replace(/&#8216;|&#8217;/g,"'").replace(/&#8220;|&#8221;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/{{/,"").replace(/}}/,"");try{e=JSON.parse(n)}catch(e){return t}void 0!==e.function&&i.extensions.forEach((function(r){t=r.parse(t,e,n,o)}))})),t):t},t.prototype.extend=function(t){this.extensions.push(t)},t}(),o=function(){function t(){this.bag={}}return t.prototype.get=function(t){return void 0!==typeof this.bag[t]?this.bag[t]:null},t.prototype.set=function(t,e){this.bag[t]=e},t}(),i=new(function(){function t(){this.gaTargetCollections=[],this.DEBUG=!1,this.gaTargetConfigurations=[],this.observeForMutations=null,this.gaTargetCollections=[],this.init=this.init.bind(this),this.observeParentWrapper=this.observeParentWrapper.bind(this),this.parentWrapperObserver=this.parentWrapperObserver.bind(this),this.onParentWrapperUpdate=this.onParentWrapperUpdate.bind(this),this.createGaTargetCollection=this.createGaTargetCollection.bind(this),this.createGaTargetInstance=this.createGaTargetInstance.bind(this),this.addEventListeners=this.addEventListeners.bind(this),this.getNodeGaLabel=this.getNodeGaLabel.bind(this)}return t.prototype.init=function(t){var e=this;t&&Object.keys(t).forEach((function(n){e[n]=t[n]})),this.gaTargetCollections=this.gaTargetConfigurations.map((function(t){return e.createGaTargetCollection(t)})),this.observeForMutations&&this.observeParentWrapper()},t.prototype.observeParentWrapper=function(){this.parentWrapperObserver().observe(this.observeForMutations,{childList:!0})},t.prototype.parentWrapperObserver=function(){return new MutationObserver(this.onParentWrapperUpdate)},t.prototype.onParentWrapperUpdate=function(t,e){console.log("mutation: ",t)},t.prototype.createGaTargetCollection=function(t){var e,n,r=this;return e=Array.prototype.slice.call(document.querySelectorAll(t.selector)),{selector:t.selector,firingEvents:t.firingEvents,argsForGa:t.argsForGa,reselectOnMutation:t.reselectOnMutation||!1,gaTargets:e.map((function(e){return n=r.createGaTargetInstance(e,t),r.addEventListeners(n),n}))}},t.prototype.createGaTargetInstance=function(t,e){var n={node:t,firingEvents:e.firingEvents,gaCommand:e.argsForGa[0],gaType:e.argsForGa[1],gaCategory:e.argsForGa[2],gaAction:e.argsForGa[3],gaLabel:e.argsForGa[4],getArgsForGa:function(){return[n.gaCommand,n.gaType,n.gaCategory,n.gaAction,n.gaLabel]}};return n.gaLabel=this.getNodeGaLabel(n),this.addEventListeners(n),n},t.prototype.addEventListeners=function(t){var e=this,n=function(){e.DEBUG?console.log("gaTarget: ",t):window.ga.apply(window,t.getArgsForGa())};t.firingEvents.forEach((function(e){t.node.addEventListener(e,n)}))},t.prototype.getNodeGaLabel=function(t){var e,n=t.node.getAttribute("ga-label");return n&&(e=t.gaLabel.replace(/{{\s*label\s*}}/gi,n)),e},t}()),a=function(){function t(){this.footnotes=[],this.globalFootnotesStorage={},this.count=this.count.bind(this),this.add=this.add.bind(this),this.addGlobal=this.addGlobal.bind(this),this.setGlobalFootnotes=this.setGlobalFootnotes.bind(this),this.getFootnotes=this.getFootnotes.bind(this)}return t.prototype.count=function(){return this.footnotes.length},t.prototype.add=function(t){var e=this.count()+1;this.footnotes.push({id:e,text:t})},t.prototype.setGlobalFootnotes=function(t){this.globalFootnotesStorage=t},t.prototype.addGlobal=function(t){t=t.toLowerCase(),this.globalFootnotesStorage.hasOwnProperty(t)&&this.add(this.globalFootnotesStorage[t])},t.prototype.getFootnotes=function(){return this.footnotes.length>0?this.footnotes:null},t}();n.d(e,"ShortcodeParser",(function(){return r})),n.d(e,"Container",(function(){return o})),n.d(e,"gaTracker",(function(){return i})),n.d(e,"Footnotes",(function(){return a}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Nob3J0Y29kZS1wYXJzZXIvU2hvcnRjb2RlUGFyc2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9jb250YWluZXIvQ29udGFpbmVyLnRzIiwid2VicGFjazovLy8uL3NyYy9nYS10cmFja2VyL0dhVHJhY2tlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZm9vdG5vdGVzL0Zvb3Rub3Rlcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJ0aGlzIiwiZXh0ZW5zaW9ucyIsInBhcnNlIiwiZXh0ZW5kIiwiY29udGVudCIsInNob3J0Y29kZU9iamVjdCIsInJlZ2V4IiwibWF0Y2hlcyIsIm9yaWdpbmFsTWF0Y2giLCJSZWdFeHAiLCJtYXRjaCIsImxlbmd0aCIsImZvckVhY2giLCJyZXBsYWNlIiwiSlNPTiIsImVyciIsImZ1bmN0aW9uIiwiZXh0ZW5zaW9uIiwicHVzaCIsImJhZyIsInVuZGVmaW5lZCIsInNldCIsImdhVHJhY2tlciIsImdhVGFyZ2V0Q29sbGVjdGlvbnMiLCJERUJVRyIsImdhVGFyZ2V0Q29uZmlndXJhdGlvbnMiLCJvYnNlcnZlRm9yTXV0YXRpb25zIiwiaW5pdCIsIm9ic2VydmVQYXJlbnRXcmFwcGVyIiwicGFyZW50V3JhcHBlck9ic2VydmVyIiwib25QYXJlbnRXcmFwcGVyVXBkYXRlIiwiY3JlYXRlR2FUYXJnZXRDb2xsZWN0aW9uIiwiY3JlYXRlR2FUYXJnZXRJbnN0YW5jZSIsImFkZEV2ZW50TGlzdGVuZXJzIiwiZ2V0Tm9kZUdhTGFiZWwiLCJjb25maWciLCJrZXlzIiwibWFwIiwiZ2FUYXJnZXRDb25maWciLCJvYnNlcnZlIiwiY2hpbGRMaXN0IiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9ucyIsIm9ic2VydmVyIiwiY29uc29sZSIsImxvZyIsImdhVGFyZ2V0Q29uZmlndXJhdGlvbiIsIm5vZGVzIiwiZ2FUYXJnZXQiLCJBcnJheSIsInNsaWNlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2VsZWN0b3IiLCJmaXJpbmdFdmVudHMiLCJhcmdzRm9yR2EiLCJyZXNlbGVjdE9uTXV0YXRpb24iLCJnYVRhcmdldHMiLCJub2RlIiwiZ2FDb21tYW5kIiwiZ2FUeXBlIiwiZ2FDYXRlZ29yeSIsImdhQWN0aW9uIiwiZ2FMYWJlbCIsImdldEFyZ3NGb3JHYSIsImhhbmRsZSIsIndpbmRvdyIsImdhIiwiZmlyaW5nRXZlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwibm9kZUxhYmVsIiwiZ2V0QXR0cmlidXRlIiwiZm9vdG5vdGVzIiwiZ2xvYmFsRm9vdG5vdGVzU3RvcmFnZSIsImNvdW50IiwiYWRkIiwiYWRkR2xvYmFsIiwic2V0R2xvYmFsRm9vdG5vdGVzIiwiZ2V0Rm9vdG5vdGVzIiwiZm9vdG5vdGVUZXh0IiwiaWQiLCJ0ZXh0IiwiZ2xvYmFsRm9vdG5vdGVzIiwidG9Mb3dlckNhc2UiXSwibWFwcGluZ3MiOiIyQkFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFD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c3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiXG5cbmludGVyZmFjZSBTaG9ydGNvZGVQYXJzZXJFeHRlbnNpb24ge1xuICBwYXJzZSggY29udGVudDogc3RyaW5nLCBzaG9ydGNvZGVPYmplY3QgOiBvYmplY3QsIG1hdGNoOiBzdHJpbmcsIG9yaWdpbmFsTWF0Y2g6IHN0cmluZyApIDogc3RyaW5nXG59XG5cbmludGVyZmFjZSBzaG9ydGNvZGVPYmplY3Qge1xuICBmdW5jdGlvbjogc3RyaW5nXG4gIHRleHQ6IHN0cmluZ1xufVxuXG5leHBvcnQgY2xhc3MgU2hvcnRjb2RlUGFyc2VyIHtcblxuICBleHRlbnNpb25zOiBBcnJheTxTaG9ydGNvZGVQYXJzZXJFeHRlbnNpb24+O1xuXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5leHRlbnNpb25zID0gW107XG4gICAgdGhpcy5wYXJzZSA9IHRoaXMucGFyc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLmV4dGVuZCA9IHRoaXMuZXh0ZW5kLmJpbmQodGhpcyk7XG4gIH1cblxuICBwYXJzZSggY29udGVudDpzdHJpbmcgKSB7XG4gICAgaWYgKCAhIGNvbnRlbnQgKSB7XG4gICAgICByZXR1cm4gY29udGVudDtcbiAgICB9XG4gIFxuICAgIGxldCBzaG9ydGNvZGVPYmplY3Q6IHNob3J0Y29kZU9iamVjdCxcbiAgICAgICAgcmVnZXg6IFJlZ0V4cCxcbiAgICAgICAgbWF0Y2hlczogQXJyYXk8c3RyaW5nPixcbiAgICAgICAgb3JpZ2luYWxNYXRjaDogc3RyaW5nO1xuICBcbiAgICAvLyBnZXQgcmVnZXggbWF0Y2hlc1xuICAgIHJlZ2V4ID0gUmVnRXhwKC97e1xccyooLio/KVxccyp9fS9nKTtcbiAgICBtYXRjaGVzID0gY29udGVudC5tYXRjaChyZWdleCk7XG4gIFxuICAgIGlmICggbWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCAmJiBtYXRjaGVzLmxlbmd0aCA+IDAgKSB7XG4gICAgICBtYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICBcbiAgICAgICAgLy8gc2F2ZSB0aGUgb3JpZ2luYWwgbWF0Y2g7IHdlJ2xsIG5lZWQgaXQgbGF0ZXJcbiAgICAgICAgb3JpZ2luYWxNYXRjaCA9IG1hdGNoO1xuICAgICAgXG4gICAgICAgIC8vIHR1cm4gdGhlIGZ1bGwgbWF0Y2ggaW50byBhIEpTT04gc3RyaW5nXG4gICAgICAgIG1hdGNoID0gYHske21hdGNofX1gO1xuICAgICAgICBtYXRjaCA9IG1hdGNoXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgvJiM4MjE2O3wmIzgyMTc7L2csIFwiJ1wiKVxuICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyYjODIyMDt8JiM4MjIxOy9nLCAnXCInKVxuICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyZsdDsvZywgJzwnKVxuICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyZndDsvZywgJz4nKVxuICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL3t7LywgJycpXG4gICAgICAgICAgICAgICAgICAucmVwbGFjZSgvfX0vLCAnJyk7XG4gIFxuICAgICAgICAvLyBhdHRlbXB0IHRvIHBhcnNlIEpTT04gaW50byBhIHZhbGlkIEpTT04gb2JqZWN0XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgc2hvcnRjb2RlT2JqZWN0ID0gSlNPTi5wYXJzZSggbWF0Y2ggKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaChlcnIpIHtcbiAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgfVxuICBcbiAgICAgICAgLy8gaGFuZGxlIHRoZSBkYXRhXG4gICAgICAgIGlmICggdHlwZW9mIHNob3J0Y29kZU9iamVjdC5mdW5jdGlvbiAhPT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgdGhpcy5leHRlbnNpb25zLmZvckVhY2goZXh0ZW5zaW9uID0+IHtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBleHRlbnNpb24ucGFyc2UoY29udGVudCwgc2hvcnRjb2RlT2JqZWN0LCBtYXRjaCwgb3JpZ2luYWxNYXRjaCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxuXG4gIGV4dGVuZChleHRlbnNpb246IFNob3J0Y29kZVBhcnNlckV4dGVuc2lvbikge1xuICAgIHRoaXMuZXh0ZW5zaW9ucy5wdXNoKGV4dGVuc2lvbik7XG4gIH1cblxufSIsImV4cG9ydCBjbGFzcyBDb250YWluZXIge1xuXG4gIGJhZzogb2JqZWN0XG4gXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYmFnID0ge307XG4gIH1cblxuICBnZXQoa2V5OiBzdHJpbmcpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcmV0dXJuIHR5cGVvZiB0aGlzLmJhZ1trZXldICE9PSB1bmRlZmluZWQgPyB0aGlzLmJhZ1trZXldIDogbnVsbDtcbiAgfVxuXG4gIHNldChrZXk6IHN0cmluZywgdmFsdWU6IGFueSkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICB0aGlzLmJhZ1trZXldID0gdmFsdWU7XG4gIH1cbiBcbn0iLCJpbnRlcmZhY2UgR2FUYXJnZXRDb25maWd1cmF0aW9uIHtcbiAgc2VsZWN0b3I6IHN0cmluZ1xuICBmaXJpbmdFdmVudHM6IEFycmF5PHN0cmluZz5cbiAgYXJnc0ZvckdhOiBBcnJheTxzdHJpbmc+XG4gIHJlc2VsZWN0T25NdXRhdGlvbj86IEJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIEdhVGFyZ2V0Q29sbGVjdGlvbiB7XG4gIHNlbGVjdG9yOiBzdHJpbmdcbiAgZ2FUYXJnZXRzOiBBcnJheTxHYVRhcmdldD5cbiAgYXJnc0ZvckdhOiBBcnJheTxzdHJpbmc+XG4gIGZpcmluZ0V2ZW50czogQXJyYXk8c3RyaW5nPlxuICByZXNlbGVjdE9uTXV0YXRpb246IEJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIEdhVGFyZ2V0IHtcbiAgbm9kZTogRWxlbWVudFxuICBnYUNvbW1hbmQ6IHN0cmluZ1xuICBnYVR5cGU6IHN0cmluZ1xuICBnYUNhdGVnb3J5OiBzdHJpbmdcbiAgZ2FBY3Rpb246IHN0cmluZ1xuICBnYUxhYmVsOiBzdHJpbmcgXG4gIGZpcmluZ0V2ZW50czogQXJyYXk8c3RyaW5nPlxufVxuXG5jbGFzcyBHYVRyYWNrZXIgIHtcblxuICBERUJVRzogQm9vbGVhbjtcbiAgZ2FUYXJnZXRDb25maWd1cmF0aW9uczogQXJyYXk8R2FUYXJnZXRDb25maWd1cmF0aW9uPlxuICBvYnNlcnZlRm9yTXV0YXRpb25zOiBFbGVtZW50XG4gIGdhVGFyZ2V0Q29sbGVjdGlvbnM6IEFycmF5PEdhVGFyZ2V0Q29sbGVjdGlvbj4gPSBbXTtcblxuICAvKipcbiAgICogY29uc3RydWN0b3JcbiAgICogXG4gICAqIEBwYXJhbSB7dm9pZH1cbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuXG4gICAgLyoqXG4gICAgICogVXNlIHRoaXMgZmxhZyBpZiB5b3Ugd2FudCB0byBjb25zb2xlLmxvZyBzdHVmZiBhbmRcbiAgICAgKiBub3Qgc2VuZCB0byBHQS5cbiAgICAgKiBcbiAgICAgKi9cbiAgICB0aGlzLkRFQlVHID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBTcGVjaWZ5IHRoZSBET00gZWxlbWVudHMgeW91J2QgbGlrZSB0byBhdHRhY2ggZXZlbnQgXG4gICAgICogbGlzdGVuZXJzIHRvIGluIHRoaXMgYXJyYXkuXG4gICAgICogXG4gICAgICovXG4gICAgdGhpcy5nYVRhcmdldENvbmZpZ3VyYXRpb25zID0gW107XG5cbiAgICAvKipcbiAgICAgKiBTcGVjaWZ5IHRoZSBwYXJlbnQgdG8gb2JzZXJ2ZSBmb3IgRE9NIGNoYW5nZXMuXG4gICAgICogXG4gICAgICovXG4gICAgdGhpcy5vYnNlcnZlRm9yTXV0YXRpb25zID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIFRoZSBlbGVtZW50cyB3ZSBhcmUgdHJhY2tpbmcuXG4gICAgICogXG4gICAgICovXG4gICAgdGhpcy5nYVRhcmdldENvbGxlY3Rpb25zID0gW107XG5cblxuICAgIC8qKlxuICAgICAqIEJpbmQgbWV0aG9kc1xuICAgICAqL1xuICAgIHRoaXMuaW5pdCA9IHRoaXMuaW5pdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub2JzZXJ2ZVBhcmVudFdyYXBwZXIgPSB0aGlzLm9ic2VydmVQYXJlbnRXcmFwcGVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5wYXJlbnRXcmFwcGVyT2JzZXJ2ZXIgPSB0aGlzLnBhcmVudFdyYXBwZXJPYnNlcnZlci5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25QYXJlbnRXcmFwcGVyVXBkYXRlID0gdGhpcy5vblBhcmVudFdyYXBwZXJVcGRhdGUuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNyZWF0ZUdhVGFyZ2V0Q29sbGVjdGlvbiA9IHRoaXMuY3JlYXRlR2FUYXJnZXRDb2xsZWN0aW9uLmJpbmQodGhpcyk7XG4gICAgdGhpcy5jcmVhdGVHYVRhcmdldEluc3RhbmNlID0gdGhpcy5jcmVhdGVHYVRhcmdldEluc3RhbmNlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVycyA9IHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMuYmluZCh0aGlzKTtcbiAgICB0aGlzLmdldE5vZGVHYUxhYmVsID0gdGhpcy5nZXROb2RlR2FMYWJlbC5iaW5kKHRoaXMpO1xuICB9XG5cblxuICAvKipcbiAgICogaW5pdFxuICAgKiBcbiAgICogU3RhcnQgdXAgdGhlIHRyYWNrZXIuIFNldCBjb25maWd1cmF0aW9uIHNldHRpbmdzIFxuICAgKiBhbmQgcmVnaXN0ZXIgcmVhY3RpdmUgZWxlbWVudHMuXG4gICAqIFxuICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBpbml0KGNvbmZpZzoge0RFQlVHOiBmYWxzZSwgb2JzZXJ2ZUZvck11dGF0aW9uczogbnVsbCwgZ2FUYXJnZXRDb25maWd1cmF0aW9uczogQXJyYXk8R2FUYXJnZXRDb25maWd1cmF0aW9uPn0pIHtcblxuICAgIC8vIHRha2UgY2FyZSBvZiBjb25maWd1cmF0aW9uIHNldHRpbmdzXG4gICAgaWYgKCBjb25maWcgKSB7XG4gICAgICBPYmplY3Qua2V5cyhjb25maWcpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzW2tleV0gPSBjb25maWdba2V5XTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIGNyZWF0ZSBhbiBhcnJheSBvZiBHYVRhcmdldENvbGxlY3Rpb25zXG4gICAgdGhpcy5nYVRhcmdldENvbGxlY3Rpb25zID0gdGhpcy5nYVRhcmdldENvbmZpZ3VyYXRpb25zLm1hcChnYVRhcmdldENvbmZpZyA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVHYVRhcmdldENvbGxlY3Rpb24oZ2FUYXJnZXRDb25maWcpO1xuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMub2JzZXJ2ZUZvck11dGF0aW9ucykge1xuICAgICAgdGhpcy5vYnNlcnZlUGFyZW50V3JhcHBlcigpO1xuICAgIH1cbiAgfVxuXG4gIC8vIG9ic2VydmUgdGhlIHNwZWNpZmllZCBwYXJlbnQgd3JhcHBlciBmb3IgRE9NIGNoYW5nZXNcbiAgb2JzZXJ2ZVBhcmVudFdyYXBwZXIoKSB7XG4gICAgdGhpcy5wYXJlbnRXcmFwcGVyT2JzZXJ2ZXIoKS5vYnNlcnZlKHRoaXMub2JzZXJ2ZUZvck11dGF0aW9ucywge1xuICAgICAgY2hpbGRMaXN0OiB0cnVlXG4gICAgfSk7XG4gIH1cblxuICAvLyByZXR1cm4gdGhlIGluc3RhbmNlIG9mIHRoZSBtdXRhdGlvbiBvYnNlcnZlclxuICBwYXJlbnRXcmFwcGVyT2JzZXJ2ZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMub25QYXJlbnRXcmFwcGVyVXBkYXRlKTtcbiAgfVxuXG4gIC8vIHdoZW4gRE9NIGNoYW5nZXMgYXJlIGRldGVjdGVkIHdpdGhpbiB0aGUgc3BlY2lmaWVkXG4gIC8vIHBhcmVudCB3cmFwcGVyXG4gIG9uUGFyZW50V3JhcHBlclVwZGF0ZShtdXRhdGlvbnM6IEFycmF5PE11dGF0aW9uUmVjb3JkPiwgb2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICBjb25zb2xlLmxvZygnbXV0YXRpb246ICcsIG11dGF0aW9ucyk7XG4gIH1cblxuICAvLyBoYW5kbGUgdGhlIGdhRXZlbnRDb25maWcgY29uZmlndXJhdGlvblxuICBjcmVhdGVHYVRhcmdldENvbGxlY3Rpb24oZ2FUYXJnZXRDb25maWd1cmF0aW9uOiBHYVRhcmdldENvbmZpZ3VyYXRpb24pIHtcblxuICAgIGxldCBub2RlczogQXJyYXk8RWxlbWVudD4sXG4gICAgICAgIGdhVGFyZ2V0OiBHYVRhcmdldCxcbiAgICAgICAgZ2FUYXJnZXRDb2xsZWN0aW9uOiBHYVRhcmdldENvbGxlY3Rpb247XG5cbiAgICBub2RlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZ2FUYXJnZXRDb25maWd1cmF0aW9uLnNlbGVjdG9yKSk7XG5cbiAgICBnYVRhcmdldENvbGxlY3Rpb24gPSB7XG5cbiAgICAgIC8vIHNldCB0aGVzZSBncm91cCBwcm9wZXJ0aWVzXG4gICAgICBzZWxlY3RvcjogZ2FUYXJnZXRDb25maWd1cmF0aW9uLnNlbGVjdG9yLFxuICAgICAgZmlyaW5nRXZlbnRzOiBnYVRhcmdldENvbmZpZ3VyYXRpb24uZmlyaW5nRXZlbnRzLFxuICAgICAgYXJnc0ZvckdhOiBnYVRhcmdldENvbmZpZ3VyYXRpb24uYXJnc0ZvckdhLFxuICAgICAgcmVzZWxlY3RPbk11dGF0aW9uOiBnYVRhcmdldENvbmZpZ3VyYXRpb24ucmVzZWxlY3RPbk11dGF0aW9uIHx8IGZhbHNlLFxuXG4gICAgICAvLyBjcmVhdGUgYW4gYXJyYXkgb2YgZ2FUYXJnZXRzXG4gICAgICBnYVRhcmdldHM6IG5vZGVzLm1hcChub2RlID0+IHtcbiAgICAgICAgZ2FUYXJnZXQgPSB0aGlzLmNyZWF0ZUdhVGFyZ2V0SW5zdGFuY2Uobm9kZSwgZ2FUYXJnZXRDb25maWd1cmF0aW9uKTtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVycyhnYVRhcmdldCk7XG4gICAgICAgIHJldHVybiBnYVRhcmdldDtcbiAgICAgIH0pXG4gICAgfTtcblxuICAgIHJldHVybiBnYVRhcmdldENvbGxlY3Rpb247XG4gIH1cblxuICBjcmVhdGVHYVRhcmdldEluc3RhbmNlKG5vZGU6IEVsZW1lbnQsIGNvbmZpZzogR2FUYXJnZXRDb25maWd1cmF0aW9uKSB7XG4gICAgbGV0IGdhVGFyZ2V0ID0ge1xuICAgICAgbm9kZTogbm9kZSxcbiAgICAgIGZpcmluZ0V2ZW50czogY29uZmlnLmZpcmluZ0V2ZW50cyxcbiAgICAgIGdhQ29tbWFuZDogY29uZmlnLmFyZ3NGb3JHYVswXSxcbiAgICAgIGdhVHlwZTogY29uZmlnLmFyZ3NGb3JHYVsxXSxcbiAgICAgIGdhQ2F0ZWdvcnk6IGNvbmZpZy5hcmdzRm9yR2FbMl0sXG4gICAgICBnYUFjdGlvbjogY29uZmlnLmFyZ3NGb3JHYVszXSxcbiAgICAgIGdhTGFiZWw6IGNvbmZpZy5hcmdzRm9yR2FbNF0sXG4gICAgICBnZXRBcmdzRm9yR2E6ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIFtnYVRhcmdldC5nYUNvbW1hbmQsIGdhVGFyZ2V0LmdhVHlwZSwgZ2FUYXJnZXQuZ2FDYXRlZ29yeSwgZ2FUYXJnZXQuZ2FBY3Rpb24sIGdhVGFyZ2V0LmdhTGFiZWxdO1xuICAgICAgfVxuICAgIH07XG4gICAgZ2FUYXJnZXQuZ2FMYWJlbCA9IHRoaXMuZ2V0Tm9kZUdhTGFiZWwoZ2FUYXJnZXQpO1xuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoZ2FUYXJnZXQpO1xuICAgIHJldHVybiBnYVRhcmdldDtcbiAgfVxuXG5cbiAgLy8gSGFuZGxlIGVhY2ggRE9NIGVsZW1lbnRcbiAgYWRkRXZlbnRMaXN0ZW5lcnMoIGdhVGFyZ2V0OiBHYVRhcmdldCApIHtcblxuICAgIGxldCBoYW5kbGUgPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5ERUJVRykge1xuICAgICAgICBjb25zb2xlLmxvZygnZ2FUYXJnZXQ6ICcsIGdhVGFyZ2V0KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHdpbmRvdy5nYSguLi5nYVRhcmdldC5nZXRBcmdzRm9yR2EoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2FUYXJnZXQuZmlyaW5nRXZlbnRzLmZvckVhY2goZmlyaW5nRXZlbnQgPT4ge1xuICAgICAgZ2FUYXJnZXQubm9kZS5hZGRFdmVudExpc3RlbmVyKGZpcmluZ0V2ZW50LCBoYW5kbGUpO1xuICAgIH0pO1xuXG4gIH1cblxuXG4gIGdldE5vZGVHYUxhYmVsKGdhVGFyZ2V0OiBHYVRhcmdldCkge1xuXG4gICAgbGV0IGdhTGFiZWwsXG4gICAgICAgIG5vZGVMYWJlbCA9IGdhVGFyZ2V0Lm5vZGUuZ2V0QXR0cmlidXRlKCdnYS1sYWJlbCcpO1xuXG4gICAgaWYgKG5vZGVMYWJlbCkge1xuICAgICAgZ2FMYWJlbCA9IGdhVGFyZ2V0LmdhTGFiZWwucmVwbGFjZSgve3tcXHMqbGFiZWxcXHMqfX0vZ2ksIG5vZGVMYWJlbCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdhTGFiZWw7XG4gIH1cblxufVxuXG5jb25zdCBnYVRyYWNrZXIgPSBuZXcgR2FUcmFja2VyKCk7XG5leHBvcnQgeyBnYVRyYWNrZXIgfTsiLCJpbnRlcmZhY2UgRm9vdG5vdGUge1xuICBpZDogbnVtYmVyXG4gIHRleHQ/OiBzdHJpbmdcbiAgZ2xvYmFsS2V5PyA6IHN0cmluZ1xufVxuXG5leHBvcnQgY2xhc3MgRm9vdG5vdGVzIHtcblxuICBmb290bm90ZXM6IEFycmF5PEZvb3Rub3RlPlxuICBnbG9iYWxGb290bm90ZXNTdG9yYWdlOiBvYmplY3RcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZvb3Rub3RlcyA9IFtdO1xuICAgIHRoaXMuZ2xvYmFsRm9vdG5vdGVzU3RvcmFnZSA9IHt9O1xuICAgIHRoaXMuY291bnQgPSB0aGlzLmNvdW50LmJpbmQodGhpcyk7XG4gICAgdGhpcy5hZGQgPSB0aGlzLmFkZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuYWRkR2xvYmFsID0gdGhpcy5hZGRHbG9iYWwuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldEdsb2JhbEZvb3Rub3RlcyA9IHRoaXMuc2V0R2xvYmFsRm9vdG5vdGVzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5nZXRGb290bm90ZXMgPSB0aGlzLmdldEZvb3Rub3Rlcy5iaW5kKHRoaXMpO1xuICB9XG4gIFxuICBjb3VudCgpIHtcbiAgICByZXR1cm4gdGhpcy5mb290bm90ZXMubGVuZ3RoO1xuICB9XG4gIFxuICBhZGQoZm9vdG5vdGVUZXh0OiBzdHJpbmcpIHtcbiAgICBsZXQgaWQgPSB0aGlzLmNvdW50KCkgKyAxO1xuICAgIHRoaXMuZm9vdG5vdGVzLnB1c2goe2lkOiBpZCwgdGV4dDogZm9vdG5vdGVUZXh0fSk7XG4gIH1cblxuICBzZXRHbG9iYWxGb290bm90ZXMoZ2xvYmFsRm9vdG5vdGVzOiBBcnJheTx7IGtleTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcgfT4pIHtcbiAgICB0aGlzLmdsb2JhbEZvb3Rub3Rlc1N0b3JhZ2UgPSBnbG9iYWxGb290bm90ZXM7XG4gIH1cblxuICBhZGRHbG9iYWwoa2V5OiBzdHJpbmcpIHtcbiAgICBrZXkgPSBrZXkudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoIHRoaXMuZ2xvYmFsRm9vdG5vdGVzU3RvcmFnZS5oYXNPd25Qcm9wZXJ0eShrZXkpICkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgdGhpcy5hZGQodGhpcy5nbG9iYWxGb290bm90ZXNTdG9yYWdlW2tleV0pO1xuICAgIH1cbiAgfVxuXG4gIGdldEZvb3Rub3RlcygpIHtcbiAgICBpZiAoIHRoaXMuZm9vdG5vdGVzLmxlbmd0aCA+IDAgKSB7XG4gICAgICByZXR1cm4gdGhpcy5mb290bm90ZXM7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbn0iLCIvL2V4cG9ydCAqIGZyb20gJy4vZm9vdG5vdGVzJztcbmV4cG9ydCAqIGZyb20gJy4vc2hvcnRjb2RlLXBhcnNlci9TaG9ydGNvZGVQYXJzZXInO1xuZXhwb3J0ICogZnJvbSAnLi9jb250YWluZXIvQ29udGFpbmVyJztcbmV4cG9ydCAqIGZyb20gJy4vZ2EtdHJhY2tlci9HYVRyYWNrZXInO1xuZXhwb3J0ICogZnJvbSAnLi9mb290bm90ZXMvRm9vdG5vdGVzJzsiXSwic291cmNlUm9vdCI6IiJ9